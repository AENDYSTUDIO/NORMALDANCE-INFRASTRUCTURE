# üöÄ NORMALDANCE - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –î–µ–ø–ª–æ–π

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π NORMALDANCE –Ω–∞ VPS —Å–µ—Ä–≤–µ—Ä Debian 12.

**–û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–µ–ª–∞–µ—Ç –≤—Å—ë:**
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (Node.js, PM2, Nginx, PostgreSQL)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall
- ‚úÖ –ê–≤—Ç–æ–±—ç–∫–∞–ø—ã
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
- Bash (Git Bash –Ω–∞ Windows, Terminal –Ω–∞ Mac/Linux)
- `sshpass` (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
- Debian 12
- Root –¥–æ—Å—Ç—É–ø
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã: 22, 80, 443

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞)

```bash
chmod +x scripts/*.sh scripts/deploy-config/*.sh
```

### 2. –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è (–æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞)

```bash
bash scripts/deploy-auto.sh
```

**–í—Å—ë!** –°–∫—Ä–∏–ø—Ç —Å–∞–º:
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
2. –£–ø–∞–∫—É–µ—Ç –∏ –∑–∞–≥—Ä—É–∑–∏—Ç –ø—Ä–æ–µ–∫—Ç
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ
4. –ó–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
5. –ü–æ–ª—É—á–∏—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~10-15 –º–∏–Ω—É—Ç

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
bash scripts/deploy-test.sh
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `scripts/deploy-auto.sh`:

```bash
SERVER_IP="89.104.67.165"           # IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
SERVER_USER="root"                  # SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
SERVER_PASSWORD="Ll6DLuwyKalfvGbF"  # SSH –ø–∞—Ä–æ–ª—å
DOMAIN_PRIMARY="normaldance.ru"     # –û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–º–µ–Ω
DOMAIN_SECONDARY="normaldance.online" # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ–º–µ–Ω
SSL_EMAIL="admin@normaldance.ru"    # Email –¥–ª—è SSL
```

## –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS**
   ```
   A    @    89.104.67.165
   A    www  89.104.67.165
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env.production** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```bash
   ssh root@89.104.67.165
   nano /var/www/normaldance/.env.production
   ```
   
   –û–±–Ω–æ–≤–∏—Ç–µ:
   - `PINATA_API_KEY` - –ø–æ–ª—É—á–∏—Ç–µ –Ω–∞ https://pinata.cloud
   - `PINATA_SECRET_API_KEY`
   - `PINATA_JWT`
   - `SENTRY_DSN` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**:
   ```bash
   ssh root@89.104.67.165 'pm2 restart normaldance'
   ```

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
ssh root@89.104.67.165 'pm2 logs normaldance'
```

### –°—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
ssh root@89.104.67.165 'pm2 status'
```

### –†–µ—Å—Ç–∞—Ä—Ç
```bash
ssh root@89.104.67.165 'pm2 restart normaldance'
```

### –õ–æ–≥–∏ Nginx
```bash
ssh root@89.104.67.165 'tail -f /var/log/nginx/normaldance-error.log'
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```bash
ssh root@89.104.67.165 'pm2 monit'
```

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
cd /path/to/NORMALDANCE
git pull
bash scripts/deploy-auto.sh  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```

## –ë—ç–∫–∞–ø—ã

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 UTC.

### –†—É—á–Ω–æ–π –±—ç–∫–∞–ø:
```bash
ssh root@89.104.67.165 '/root/backup-normaldance.sh'
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞:
```bash
ssh root@89.104.67.165
cd /backups/normaldance
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î
gunzip < db_YYYYMMDD_HHMMSS.sql.gz | psql -U normaldance normaldance
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
tar -xzf files_YYYYMMDD_HHMMSS.tar.gz -C /var/www/
pm2 restart normaldance
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤

```
scripts/
‚îú‚îÄ‚îÄ deploy-auto.sh              # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
‚îú‚îÄ‚îÄ server-setup.sh             # –°–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ deploy-test.sh              # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
‚îî‚îÄ‚îÄ deploy-config/
    ‚îú‚îÄ‚îÄ nginx.conf              # –ö–æ–Ω—Ñ–∏–≥ Nginx
    ‚îú‚îÄ‚îÄ ecosystem.config.js     # –ö–æ–Ω—Ñ–∏–≥ PM2
    ‚îî‚îÄ‚îÄ backup.sh               # –°–∫—Ä–∏–ø—Ç –±—ç–∫–∞–ø–∞
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: SSL –Ω–µ –ø–æ–ª—É—á–µ–Ω
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```bash
nslookup normaldance.ru
```
–î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å 89.104.67.165

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
ssh root@89.104.67.165 'pm2 logs normaldance --lines 50'
```

### –ü—Ä–æ–±–ª–µ–º–∞: 502 Bad Gateway
**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `pm2 status`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Nginx: `tail -f /var/log/nginx/normaldance-error.log`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `pm2 restart normaldance && systemctl restart nginx`

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP –∏ –ø–∞—Ä–æ–ª—å –≤ `deploy-auto.sh`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞: `ping 89.104.67.165`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –ø–æ—Ä—Ç: `telnet 89.104.67.165 22`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –¥–µ–ø–ª–æ—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–°–º–µ–Ω–∏—Ç—å root –ø–∞—Ä–æ–ª—å**:
   ```bash
   ssh root@89.104.67.165 'passwd'
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSH –∫–ª—é—á–∏** (–≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª—è)

3. **–û—Ç–∫–ª—é—á–∏—Ç—å root –ª–æ–≥–∏–Ω –ø–æ –ø–∞—Ä–æ–ª—é**:
   ```bash
   ssh root@89.104.67.165
   sed -i 's/#PermitRootLogin yes/PermitRootLogin prohibit-password/' /etc/ssh/sshd_config
   systemctl restart sshd
   ```

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å fail2ban**:
   ```bash
   apt install fail2ban
   systemctl enable fail2ban
   ```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã:
- **Sentry** (–æ—à–∏–±–∫–∏): https://sentry.io
- **UptimeRobot** (–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å): https://uptimerobot.com
- **Datadog** (–º–µ—Ç—Ä–∏–∫–∏): https://www.datadoghq.com

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://github.com/AENDYSTUDIO/NORMAL-DANCE
Issues: https://github.com/AENDYSTUDIO/NORMAL-DANCE/issues

---

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤–∞—à NORMALDANCE —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ https://normaldance.ru üöÄ**
