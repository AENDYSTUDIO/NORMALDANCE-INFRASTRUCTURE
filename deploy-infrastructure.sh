#!/bin/bash

# ==============================================
# ðŸš€ NORMAL DANCE COMPLETE INFRASTRUCTURE DEPLOYMENT
# ==============================================
# ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ñ†Ð¸ÐºÐ» Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð¾Ñ‚ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð´Ð¾ ÐºÐ¾Ð½Ñ†Ð°

set -e

# Ð¦Ð²ÐµÑ‚Ð° Ð´Ð»Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð°
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m' # No Color

# ==============================================
# ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð¯
# ==============================================

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ
PROJECT_NAME="normaldance"
APP_URL="https://normaldance.online"
DEPLOY_ENV="production"

# ==============================================
# Ð¤Ð£ÐÐšÐ¦Ð˜Ð˜
# ==============================================

log_header() {
    echo -e "${BLUE}"
    echo "=========================================="
    echo "$1"
    echo "=========================================="
    echo -e "${NC}"
}

log_info() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

log_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

log_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

print_banner() {
    echo -e "${GREEN}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                 ðŸš€ NORMAL DANCE                          â•‘"
    echo "â•‘           COMPLETE INFRASTRUCTURE DEPLOYMENT             â•‘"
    echo "â•‘                                                          â•‘"
    echo "â•‘      Web3 Music Platform with Solana Integration         â•‘"
    echo "â•‘                                                          â•‘"
    echo "â•‘              Automated Deployment Pipeline               â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
}

check_prerequisites() {
    log_header "ðŸ” ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ ÐŸÐ Ð•Ð”Ð’ÐÐ Ð˜Ð¢Ð•Ð›Ð¬ÐÐ«Ð¥ Ð¢Ð Ð•Ð‘ÐžÐ’ÐÐÐ˜Ð™"

    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð¾Ð¹ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
    log_info "ÐžÐ¿ÐµÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°: $(uname -a)"

    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Node.js
    if ! command -v node &> /dev/null; then
        log_error "Node.js Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½"
        exit 1
    fi
    log_info "Node.js Ð²ÐµÑ€ÑÐ¸Ñ: $(node -v)"

    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° npm
    if ! command -v npm &> /dev/null; then
        log_error "npm Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½"
        exit 1
    fi
    log_info "npm Ð²ÐµÑ€ÑÐ¸Ñ: $(npm -v)"

    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Git
    if ! command -v git &> /dev/null; then
        log_error "Git Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½"
        exit 1
    fi
    log_info "Git Ð²ÐµÑ€ÑÐ¸Ñ: $(git --version)"

    log_success "Ð’ÑÐµ Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹"
}

setup_secrets() {
    log_header "ðŸ” ÐÐÐ¡Ð¢Ð ÐžÐ™ÐšÐ Ð‘Ð•Ð—ÐžÐŸÐÐ¡ÐÐ«Ð¥ Ð¡Ð•ÐšÐ Ð•Ð¢ÐžÐ’"

    if [ ! -f "generate-secrets.sh" ]; then
        log_error "Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ generate-secrets.sh Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½"
        exit 1
    fi

    chmod +x generate-secrets.sh
    ./generate-secrets.sh

    log_success "Ð¡ÐµÐºÑ€ÐµÑ‚Ñ‹ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ñ‹"
}

security_audit() {
    log_header "ðŸ”’ ÐÐ£Ð”Ð˜Ð¢ Ð‘Ð•Ð—ÐžÐŸÐÐ¡ÐÐžÐ¡Ð¢Ð˜"

    if [ ! -f "security-check.sh" ]; then
        log_error "Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ security-check.sh Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½"
        exit 1
    fi

    chmod +x security-check.sh
    if ./security-check.sh; then
        log_success "ÐÑƒÐ´Ð¸Ñ‚ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½"
    else
        log_warning "ÐÐ°Ð¹Ð´ÐµÐ½Ñ‹ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸, Ð½Ð¾ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÑŽ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ"
    fi
}

build_application() {
    log_header "ðŸ—ï¸ Ð¡Ð‘ÐžÐ ÐšÐ ÐŸÐ Ð˜Ð›ÐžÐ–Ð•ÐÐ˜Ð¯"

    log_info "Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹..."
    npm ci

    log_info "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‚Ð¸Ð¿Ð¾Ð² TypeScript..."
    if npm run type-check 2>/dev/null; then
        log_success "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‚Ð¸Ð¿Ð¾Ð² Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½Ð°"
    else
        log_warning "ÐÐ°Ð¹Ð´ÐµÐ½Ñ‹ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ñ‚Ð¸Ð¿Ð¾Ð², Ð½Ð¾ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÑŽ"
    fi

    log_info "Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ð°..."
    npm run build

    log_success "ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ ÑÐ¾Ð±Ñ€Ð°Ð½Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾"
}

deploy_to_vercel() {
    log_header "ðŸš€ Ð ÐÐ—Ð’Ð•Ð Ð¢Ð«Ð’ÐÐÐ˜Ð• ÐÐ VERCEL"

    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Vercel
    if ! vercel whoami &> /dev/null; then
        log_error "ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð²Ð¾Ð¹Ñ‚Ð¸ Ð² Vercel CLI"
        log_info "Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ: vercel login"
        exit 1
    fi

    log_info "Ð—Ð°Ð¿ÑƒÑÐº Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ..."
    if vercel --prod; then
        log_success "Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ Ð½Ð° Vercel Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾"
    else
        log_error "ÐžÑˆÐ¸Ð±ÐºÐ° Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð½Ð° Vercel"
        exit 1
    fi
}

verify_deployment() {
    log_header "âœ… ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð ÐÐ—Ð’Ð•Ð Ð¢Ð«Ð’ÐÐÐ˜Ð¯"

    if [ ! -f "post-deploy-verification.sh" ]; then
        log_error "Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ post-deploy-verification.sh Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½"
        exit 1
    fi

    chmod +x post-deploy-verification.sh
    ./post-deploy-verification.sh

    log_success "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°"
}

setup_monitoring() {
    log_header "ðŸ“Š ÐÐÐ¡Ð¢Ð ÐžÐ™ÐšÐ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“Ð"

    if [ ! -f "setup-monitoring.sh" ]; then
        log_error "Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ setup-monitoring.sh Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½"
        exit 1
    fi

    chmod +x setup-monitoring.sh
    ./setup-monitoring.sh

    log_success "ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½"
}

generate_documentation() {
    log_header "ðŸ“š Ð“Ð•ÐÐ•Ð ÐÐ¦Ð˜Ð¯ Ð”ÐžÐšÐ£ÐœÐ•ÐÐ¢ÐÐ¦Ð˜Ð˜"

    # Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð° Ð¾ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¸
    local report_file="INFRASTRUCTURE_DEPLOYMENT_REPORT_$(date +%Y%m%d_%H%M%S).md"

    cat > "$report_file" << EOF
# ÐžÑ‚Ñ‡ÐµÑ‚ Ð¾ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¸ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ NormalDance

## Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¸

- **Ð”Ð°Ñ‚Ð°**: $(date)
- **ÐŸÑ€Ð¾ÐµÐºÑ‚**: $PROJECT_NAME
- **Ð¡Ñ€ÐµÐ´Ð°**: $DEPLOY_ENV
- **URL**: $APP_URL
- **Ð¡Ñ‚Ð°Ñ‚ÑƒÑ**: âœ… Ð£Ð¡ÐŸÐ•Ð¨ÐÐž

## Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ðµ ÑÑ‚Ð°Ð¿Ñ‹

### âœ… ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ°
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ð¹
- Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ñ… ÑÐµÐºÑ€ÐµÑ‚Ð¾Ð²
- ÐÑƒÐ´Ð¸Ñ‚ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

### âœ… Ð¡Ð±Ð¾Ñ€ÐºÐ°
- Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‚Ð¸Ð¿Ð¾Ð² TypeScript
- Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ

### âœ… Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ
- Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð½Ð° Vercel
- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð´Ð¾Ð¼ÐµÐ½Ð°
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸

### âœ… ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³
- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ¸
- ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð°Ð»ÐµÑ€Ñ‚Ð¾Ð²
- ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸

## Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑˆÐ°Ð³Ð¸

1. **ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³**: Ð¡Ð»ÐµÐ´Ð¸Ñ‚Ðµ Ð·Ð° Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ°Ð¼Ð¸ Ð² Ð¿ÐµÑ€Ð²Ñ‹Ðµ 24 Ñ‡Ð°ÑÐ°
2. **Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ**: ÐŸÑ€Ð¾Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð¾Ð»Ð½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸
3. **Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ**: ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÑƒÑŽ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸ÑŽ
4. **Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ**: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾Ðµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
5. **ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹**: ÐŸÑ€Ð¾Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð½Ð¾Ð²Ñ‹Ð¼ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑÐ¼

## ÐŸÐ¾Ð»ÐµÐ·Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹

\`\`\`bash
# ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ
vercel ls

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð»Ð¾Ð³Ð¾Ð²
vercel logs --follow

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ
curl $APP_URL/api/health

# ÐžÑ‚ÐºÐ°Ñ‚ Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸
vercel rollback
\`\`\`

## ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹

- **DevOps**: devops@normaldance.online
- **Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°**: support@normaldance.online
- **Ð­ÐºÑÑ‚Ñ€ÐµÐ½Ð½Ñ‹Ðµ ÑÐ»ÑƒÑ‡Ð°Ð¸**: emergency@normaldance.online

---
*ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð¼ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ*
EOF

    log_success "ÐžÑ‚Ñ‡ÐµÑ‚ Ð¾ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½: $report_file"
}

# ==============================================
# ÐžÐ¡ÐÐžÐ’ÐÐžÐ™ ÐŸÐ ÐžÐ¦Ð•Ð¡Ð¡ Ð ÐÐ—Ð’Ð•Ð Ð¢Ð«Ð’ÐÐÐ˜Ð¯
# ==============================================

main() {
    print_banner

    log_info "Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ð¾Ð»Ð½Ð¾Ð³Ð¾ Ñ†Ð¸ÐºÐ»Ð° Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹..."
    log_info "Ð­Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð·Ð°Ð½ÑÑ‚ÑŒ 10-15 Ð¼Ð¸Ð½ÑƒÑ‚"

    echo
    read -p "ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ? (y/N): " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        log_info "Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼"
        exit 0
    fi

    # Ð­Ñ‚Ð°Ð¿ 1: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ð¹
    check_prerequisites

    # Ð­Ñ‚Ð°Ð¿ 2: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° ÑÐµÐºÑ€ÐµÑ‚Ð¾Ð²
    setup_secrets

    # Ð­Ñ‚Ð°Ð¿ 3: ÐÑƒÐ´Ð¸Ñ‚ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸
    security_audit

    # Ð­Ñ‚Ð°Ð¿ 4: Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
    build_application

    # Ð­Ñ‚Ð°Ð¿ 5: Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ Ð½Ð° Vercel
    deploy_to_vercel

    # Ð­Ñ‚Ð°Ð¿ 6: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ
    verify_deployment

    # Ð­Ñ‚Ð°Ð¿ 7: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°
    setup_monitoring

    # Ð­Ñ‚Ð°Ð¿ 8: Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸
    generate_documentation

    # Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð½Ð½ÐµÑ€ ÑƒÑÐ¿ÐµÑ…Ð°
    echo -e "${GREEN}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘           ðŸŽ‰ Ð ÐÐ—Ð’Ð•Ð Ð¢Ð«Ð’ÐÐÐ˜Ð• Ð—ÐÐ’Ð•Ð Ð¨Ð•ÐÐž! ðŸŽ‰                â•‘"
    echo "â•‘                                                          â•‘"
    echo "â•‘      ÐŸÐ»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð° NormalDance Ð³Ð¾Ñ‚Ð¾Ð²Ð° Ðº Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ!       â•‘"
    echo "â•‘                                                          â•‘"
    echo "â•‘            ðŸŒ $APP_URL                                   â•‘"
    echo "â•‘                                                          â•‘"
    echo "â•‘     ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€ÑŒÑ‚Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð¸ Ð½Ð°ÑÐ»Ð°Ð¶Ð´Ð°Ð¹Ñ‚ÐµÑÑŒ ÑƒÑÐ¿ÐµÑ…Ð¾Ð¼!       â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"

    log_info "Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑˆÐ°Ð³Ð¸:"
    log_info "1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ $APP_URL Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ"
    log_info "2. ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸"
    log_info "3. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸"
    log_info "4. ÐžÐ±ÑƒÑ‡Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ Ñ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð¾Ð¹"
    log_info "5. ÐŸÐ»Ð°Ð½Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ñ€ÐµÐ»Ð¸Ð·"

    echo
    log_success "ðŸŽµ Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² Ð¼Ð¸Ñ€ Web3 Ð¼ÑƒÐ·Ñ‹ÐºÐ¸! ðŸŽµ"
}

# ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ð¹
trap 'log_error "Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€ÐµÑ€Ð²Ð°Ð½Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼"; exit 1' INT TERM

# Ð—Ð°Ð¿ÑƒÑÐº Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°
main "$@"