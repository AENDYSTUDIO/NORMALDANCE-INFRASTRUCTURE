# Telegram Mini App Moderation Checklist

Этот чек-лист поможет подготовить приложение к модерации в Telegram, следуя рекомендациям из обсуждения.

## 1. Manifest и основные настройки

- [ ] `manifest.json` содержит правильное значение `short_name` (совпадает с BotFather Short name)
- [ ] В `manifest.json` указаны `"scope": "./"` и `"start_url": "./"`
- [ ] Логотип 512×512 прозрачный PNG
- [ ] Иконка 100×100 без текста
- [ ] У бота включен режим «Inline Locations» и «Menu Button» → «Commands»

## 2. Content Security Policy (CSP)

- [ ] CSP не содержит `'unsafe-inline'` и `'unsafe-eval'`
- [ ] Все скрипты загружаются только с разрешенных источников
- [ ] `script-src` включает только `self` и разрешенные домены Telegram
- [ ] Service Worker (`sw.js`) загружается только если действительно нужен

## 3. Безопасность и аутентификация

- [ ] Используется правильная аутентификация через Telegram Web App
- [ ] Проверяется `auth_date` (≤ 30 минут)
- [ ] `TELEGRAM_BOT_TOKEN` хранится только на сервере
- [ ] Все внешние вызовы проксируются через бэкенд

## 4. Web3 интеграция

- [ ] Используется WalletConnect (Universal) + QR / deep-link для TMA
- [ ] Solana Pay URL открывается через `window.open(paymentUrl, '_blank')`
- [ ] После открытия показывается инлайн-скрин «Ждем оплату…» с кнопкой «Проверить»
- [ ] Нет использования стандартных адаптеров `@solana/wallet-adapter-*` в TMA

## 5. UX/UI ограничения Telegram

- [ ] Главная кнопка (`MainButton`) используется для ключевых действий
- [ ] Нет дублирующих CTA-кнопок в интерфейсе
- [ ] Цвет `themeParams.bg_color` в темной теме проверен на контрастность
- [ ] Обработчик `onEvent('backButtonClicked', ...)` установлен
- [ ] `backButton.show()` / `hide()` вызываются корректно

## 6. Монетизация

- [ ] Telegram Stars используется как основной способ оплаты
- [ ] Альтернативный способ оплаты через SOL (конвертация 1 ⭐ ≈ 0.01 USD)
- [ ] Для вторичного рынка NFT добавлен отдельный раздел «Marketplace»

## 7. Технические требования

- [ ] Нет всплывающих окон `alert()` / `confirm()` (заменены на кастомные)
- [ ] Все ссылки открываются через `web_app_open_link`
- [ ] Есть экран-заглушка «Мини-приложение недоступно» с кнопкой «Написать в поддержку»
- [ ] Приложение работает без аналитических скриптов (Google Analytics, Facebook Pixel и т.д.)

## 8. Метрики и пост-релиз

- [ ] События отправляются через Bot API метод `sendEvent`
- [ ] Хранятся `user_id` и `chat_instance` из `window.Telegram.WebApp.initDataUnsafe`
- [ ] Подготовлен план A/B тестирования через 2 недели после релиза

## 9. Финальная проверка перед подачей

- [ ] Приложение протестировано на iOS и Android
- [ ] Проверена работа в светлой и темной темах
- [ ] Все внешние ссылки открываются корректно
- [ ] Нет ошибок в консоли браузера
- [ ] Приложение быстро загружается (Lighthouse Performance ≥ 90)

## 10. Документация

- [ ] Обновлена документация по Telegram Mini App
- [ ] Подготовлено описание функционала для модераторов
- [ ] Указаны все используемые домены и причины их использования

---

**Примечание:** После первой успешной модерации можно добавить аналитические скрипты и улучшить функционал в последующих обновлениях.
