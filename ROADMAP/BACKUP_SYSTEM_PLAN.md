# –ü–ª–∞–Ω —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

## –û–±–∑–æ—Ä

–í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞–¥–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ NormalDance. –≠—Ç–æ —É–ª—É—á—à–µ–Ω–∏–µ –∏–º–µ–µ—Ç –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è Q3-Q4 2025 –≥–æ–¥–∞, —Ç–∞–∫ –∫–∞–∫ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ–µ–≤.

## –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

### –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ù–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è
- –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–±–æ—è—Ö
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –ù–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è

## –¶–µ–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–µ–ª–∏

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ü–µ–ª–∏

- –ù–∞–¥–µ–∂–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
- –ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

## –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–ù–µ–¥–µ–ª—è 1-2)

- –ê–Ω–∞–ª–∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±—ç–∫–∞–ø–∞
- –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –±—ç–∫–∞–ø–∞
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–ù–µ–¥–µ–ª—è 3-4)

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â –¥–ª—è –±—ç–∫–∞–ø–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –±—ç–∫–∞–ø–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –≠—Ç–∞–ø 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±—ç–∫–∞–ø–∞ (–ù–µ–¥–µ–ª—è 5-6)

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞ –ë–î
- –ë—ç–∫–∞–ø —Ñ–∞–π–ª–æ–≤ –∏ –º–µ–¥–∏–∞
- –ë—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –ö—Ä–∏–ø—Ç–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –≠—Ç–∞–ø 4: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–ù–µ–¥–µ–ª—è 7-8)

- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–¥—É—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### –≠—Ç–∞–ø 5: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ (–ù–µ–¥–µ–ª—è 9)

- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

#### –°—Ö–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π

```
backup-storage/
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ daily/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ normaldance_2025-01-01.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ normaldance_2025-01-02.sql
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ weekly/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ normaldance_week_01_2025.sql
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ monthly/
‚îÇ       ‚îú‚îÄ‚îÄ normaldance_jan_2025.sql
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ files/
‚îÇ   ‚îú‚îÄ‚îÄ daily/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ media_2025-01-01.tar.gz
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ archives/
‚îÇ       ‚îú‚îÄ‚îÄ media_jan_2025.tar.gz
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îú‚îÄ‚îÄ daily/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ configs_2025-01-01.tar.gz
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ archives/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ logs/
    ‚îú‚îÄ‚îÄ backup_logs_2025-01-01.txt
    ‚îî‚îÄ‚îÄ ...
```

### –ü–æ–ª–∏—Ç–∏–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

#### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —á–∞—Å—Ç–æ—Ç–∞ –±—ç–∫–∞–ø–∞

```typescript
// src/lib/backup-policy.ts
export interface BackupPolicy {
  resourceType: "database" | "files" | "configs" | "logs";
  frequency: "hourly" | "daily" | "weekly" | "monthly";
  retentionPeriod: number; // –≤ –¥–Ω—è—Ö
  storageClass: "hot" | "warm" | "cold"; // –¥–ª—è –æ–±–ª–∞—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
  encryption: boolean;
  compression: boolean;
  verification: boolean;
}

export const BACKUP_POLICIES: Record<string, BackupPolicy> = {
  // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø, 30 –¥–Ω–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è
  database: {
    resourceType: "database",
    frequency: "daily",
    retentionPeriod: 30,
    storageClass: "hot",
    encryption: true,
    compression: true,
    verification: true,
  },

  // –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã - –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –±—ç–∫–∞–ø, 90 –¥–Ω–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è
  mediaFiles: {
    resourceType: "files",
    frequency: "weekly",
    retentionPeriod: 90,
    storageClass: "warm",
    encryption: true,
    compression: true,
    verification: false,
  },

  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø, 365 –¥–Ω–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è
  configs: {
    resourceType: "configs",
    frequency: "daily",
    retentionPeriod: 365,
    storageClass: "cold",
    encryption: true,
    compression: true,
    verification: true,
  },

  // –õ–æ–≥–∏ - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø, 7 –¥–Ω–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è
  logs: {
    resourceType: "logs",
    frequency: "daily",
    retentionPeriod: 7,
    storageClass: "hot",
    encryption: false,
    compression: true,
    verification: false,
  },
};
```

### –°–µ—Ä–≤–∏—Å —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

#### –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –±—ç–∫–∞–ø–∞

```typescript
// src/lib/backup-service.ts
import { exec } from "child_process";
import {
  createReadStream,
  createWriteStream,
  promises as fsPromises,
} from "fs";
import { join } from "path";
import { promisify } from "util";
import * as AWS from "aws-sdk";
import * as zlib from "zlib";
import { BACKUP_POLICIES } from "./backup-policy";

const execPromise = promisify(exec);

export class BackupService {
  private static s3: AWS.S3;
  private static readonly BACKUP_DIR = process.env.BACKUP_DIR || "./backups";

  static initialize() {
    this.s3 = new AWS.S3({
      accessKeyId: process.env.AWS_ACCESS_KEY_ID,
      secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,
      region: process.env.AWS_REGION || "us-east-1",
    });
  }

  static async createDatabaseBackup(): Promise<string> {
    const policy = BACKUP_POLICIES.database;
    const timestamp = new Date().toISOString().split("T")[0];
    const filename = `normaldance_${timestamp}.sql`;
    const filepath = join(this.BACKUP_DIR, "database", "daily", filename);

    // –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    const dbUrl = process.env.DATABASE_URL;
    if (!dbUrl) {
      throw new Error("DATABASE_URL is not defined");
    }

    // –î–ª—è PostgreSQL
    if (dbUrl.includes("postgresql")) {
      const command = `pg_dump "${dbUrl}" > "${filepath}"`;
      await execPromise(command);
    }
    // –î–ª—è SQLite
    else if (dbUrl.includes("sqlite")) {
      const dbPath = dbUrl.replace("file:", "");
      const command = `cp "${dbPath}" "${filepath}"`;
      await execPromise(command);
    }

    // –°–∂–∞—Ç–∏–µ —Ñ–∞–π–ª–∞
    if (policy.compression) {
      await this.compressFile(filepath);
    }

    // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
    if (policy.encryption) {
      await this.encryptFile(filepath + ".gz");
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    await this.uploadToCloud(filepath + ".gz.enc", "database");

    return filepath + ".gz.enc";
  }

  static async createMediaFilesBackup(): Promise<string> {
    const policy = BACKUP_POLICIES.mediaFiles;
    const timestamp = new Date().toISOString().split("T")[0];
    const filename = `media_${timestamp}.tar.gz`;
    const filepath = join(this.BACKUP_DIR, "files", "daily", filename);

    // –ê—Ä—Ö–∏–≤–∞—Ü–∏—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
    const mediaDir = process.env.MEDIA_DIR || "./public/media";
    const command = `tar -czf "${filepath}" -C "${mediaDir}" .`;
    await execPromise(command);

    // –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    await this.uploadToCloud(filepath, "files");

    return filepath;
  }

  static async createConfigsBackup(): Promise<string> {
    const policy = BACKUP_POLICIES.configs;
    const timestamp = new Date().toISOString().split("T")[0];
    const filename = `configs_${timestamp}.tar.gz`;
    const filepath = join(this.BACKUP_DIR, "configs", "daily", filename);

    // –ê—Ä—Ö–∏–≤–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
    const configFiles = [
      "./.env",
      "./next.config.js",
      "./package.json",
      "./prisma/schema.prisma",
      "./nginx.conf",
      "./docker-compose.yml",
    ];

    // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥–æ–≤
    const tempDir = join(this.BACKUP_DIR, "temp", timestamp);
    await fsPromises.mkdir(tempDir, { recursive: true });

    for (const configFile of configFiles) {
      try {
        await fsPromises.copyFile(
          configFile,
          join(tempDir, configFile.split("/").pop() || "")
        );
      } catch (error) {
        console.warn(`Could not backup config file: ${configFile}`, error);
      }
    }

    // –ê—Ä—Ö–∏–≤–∞—Ü–∏—è
    const command = `tar -czf "${filepath}" -C "${tempDir}" .`;
    await execPromise(command);

    // –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    await fsPromises.rm(tempDir, { recursive: true, force: true });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    await this.uploadToCloud(filepath, "configs");

    return filepath;
  }

  static async compressFile(filepath: string): Promise<string> {
    return new Promise((resolve, reject) => {
      const gzip = zlib.createGzip();
      const readStream = createReadStream(filepath);
      const writeStream = createWriteStream(filepath + ".gz");

      readStream.pipe(gzip).pipe(writeStream);

      writeStream.on("finish", () => resolve(filepath + ".gz"));
      writeStream.on("error", reject);
    });
  }

  static async encryptFile(filepath: string): Promise<string> {
    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–¥–µ–∂–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
    // –ü–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞ - –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
    const encryptedPath = filepath + ".enc";
    await fsPromises.rename(filepath, encryptedPath);
    return encryptedPath;
  }

  static async uploadToCloud(
    filepath: string,
    resourceType: string
  ): Promise<void> {
    try {
      const fileContent = await fsPromises.readFile(filepath);
      const key = `${resourceType}/${
        new Date().toISOString().split("T")[0]
      }/${filepath.split("/").pop()}`;

      await this.s3
        .upload({
          Bucket: process.env.BACKUP_S3_BUCKET!,
          Key: key,
          Body: fileContent,
          ServerSideEncryption: "AES256",
        })
        .promise();

      console.log(`Successfully uploaded ${filepath} to S3`);
    } catch (error) {
      console.error(`Failed to upload ${filepath} to S3:`, error);
      throw error;
    }
  }

  static async verifyBackup(filepath: string): Promise<boolean> {
    try {
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–∞
      const stats = await fsPromises.stat(filepath);
      return stats.size > 0;
    } catch (error) {
      console.error(`Failed to verify backup ${filepath}:`, error);
      return false;
    }
  }

  static async cleanupOldBackups(
    resourceType: string,
    retentionDays: number
  ): Promise<void> {
    const policy =
      BACKUP_POLICIES[resourceType as keyof typeof BACKUP_POLICIES];
    if (!policy) {
      throw new Error(`Unknown resource type: ${resourceType}`);
    }

    const cutoffDate = new Date();
    cutoffDate.setDate(cutoffDate.getDate() - retentionDays);

    const backupDir = join(this.BACKUP_DIR, resourceType);
    const files = await fsPromises.readdir(backupDir, { withFileTypes: true });

    for (const file of files) {
      if (file.isFile()) {
        const filePath = join(backupDir, file.name);
        const fileStat = await fsPromises.stat(filePath);

        if (fileStat.mtime < cutoffDate) {
          await fsPromises.unlink(filePath);
          console.log(`Deleted old backup: ${filePath}`);
        }
      }
    }
  }

  static async runScheduledBackup(
    backupType: keyof typeof BACKUP_POLICIES
  ): Promise<void> {
    try {
      let backupFile: string;

      switch (backupType) {
        case "database":
          backupFile = await this.createDatabaseBackup();
          break;
        case "mediaFiles":
          backupFile = await this.createMediaFilesBackup();
          break;
        case "configs":
          backupFile = await this.createConfigsBackup();
          break;
        default:
          throw new Error(`Unknown backup type: ${backupType}`);
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–∞
      const policy = BACKUP_POLICIES[backupType];
      if (policy.verification) {
        const isVerified = await this.verifyBackup(backupFile);
        if (!isVerified) {
          throw new Error(`Backup verification failed for ${backupFile}`);
        }
      }

      console.log(`Successfully created ${backupType} backup: ${backupFile}`);

      // –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤
      await this.cleanupOldBackups(backupType, policy.retentionPeriod);
    } catch (error) {
      console.error(`Backup failed for ${backupType}:`, error);
      throw error;
    }
  }
}
```

### –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

#### Cron-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞

```bash
#!/bin/bash
# backup-cron.sh

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
export NODE_ENV=production
export BACKUP_DIR="/var/backups/normaldance"

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –±—ç–∫–∞–ø–æ–≤
mkdir -p $BACKUP_DIR/database/daily
mkdir -p $BACKUP_DIR/database/weekly
mkdir -p $BACKUP_DIR/database/monthly
mkdir -p $BACKUP_DIR/files/daily
mkdir -p $BACKUP_DIR/files/archives
mkdir -p $BACKUP_DIR/configs/daily
mkdir -p $BACKUP_DIR/configs/archives
mkdir -p $BACKUP_DIR/logs

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_FILE="$BACKUP_DIR/logs/backup_$(date +%Y-%m-%d).log"
echo "$(date): Starting backup process" >> $LOG_FILE

# –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
echo "$(date): Starting database backup" >> $LOG_FILE
if npm run backup:database >> $LOG_FILE 2>&1; then
    echo "$(date): Database backup completed successfully" >> $LOG_FILE
else
    echo "$(date): Database backup failed" >> $LOG_FILE
    # –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–±–æ–µ
    curl -X POST "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK" \
         -H 'Content-type: application/json' \
         --data '{"text":"Database backup failed!"}'
fi

# –ë—ç–∫–∞–ø —Ñ–∞–π–ª–æ–≤
echo "$(date): Starting files backup" >> $LOG_FILE
if npm run backup:files >> $LOG_FILE 2>&1; then
    echo "$(date): Files backup completed successfully" >> $LOG_FILE
else
    echo "$(date): Files backup failed" >> $LOG_FILE
fi

# –ë—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥–æ–≤
echo "$(date): Starting configs backup" >> $LOG_FILE
if npm run backup:configs >> $LOG_FILE 2>&1; then
    echo "$(date): Configs backup completed successfully" >> $LOG_FILE
else
    echo "$(date): Configs backup failed" >> $LOG_FILE
fi

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤ (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find $BACKUP_DIR/logs -name "*.log" -mtime +30 -delete

echo "$(date): Backup process completed" >> $LOG_FILE
echo "----------------------------------------" >> $LOG_FILE
```

### API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—ç–∫–∞–ø–∞–º–∏

#### API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –±—ç–∫–∞–ø–∞

```typescript
// src/app/api/backup/route.ts
import { NextRequest, NextResponse } from "next/server";
import { getServerSession } from "next-auth/next";
import { authOptions } from "@/lib/auth";
import { BackupService } from "@/lib/backup-service";

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –±—ç–∫–∞–ø–∞
BackupService.initialize();

export async function GET(request: NextRequest) {
  const session = await getServerSession(authOptions);

  if (!session || session.user.role !== "admin") {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  try {
    const { searchParams } = new URL(request.url);
    const action = searchParams.get("action");

    switch (action) {
      case "status":
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞
        return NextResponse.json({
          lastBackup: new Date().toISOString(),
          status: "success",
          nextBackup: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
        });

      case "list":
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –±—ç–∫–∞–ø–æ–≤ –∏–∑ S3
        return NextResponse.json({
          backups: [
            {
              id: "db-2025-01-01",
              type: "database",
              date: "2025-01-01",
              size: "1.2GB",
            },
            {
              id: "files-2025-01-01",
              type: "files",
              date: "2025-01-01",
              size: "50GB",
            },
            {
              id: "configs-2025-01-01",
              type: "configs",
              date: "2025-01-01",
              size: "2MB",
            },
          ],
        });

      default:
        return NextResponse.json({ error: "Invalid action" }, { status: 400 });
    }
  } catch (error) {
    console.error("Error in backup API:", error);
    return NextResponse.json(
      { error: "Internal Server Error" },
      { status: 500 }
    );
  }
}

export async function POST(request: NextRequest) {
  const session = await getServerSession(authOptions);

  if (!session || session.user.role !== "admin") {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  try {
    const body = await request.json();
    const { action, type } = body;

    switch (action) {
      case "create":
        if (!type || !["database", "mediaFiles", "configs"].includes(type)) {
          return NextResponse.json(
            { error: "Invalid backup type" },
            { status: 400 }
          );
        }

        await BackupService.runScheduledBackup(type);
        return NextResponse.json({
          success: true,
          message: `Backup of ${type} completed`,
        });

      case "restore":
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
        // –í–ù–ò–ú–ê–ù–ò–ï: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ - –æ—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
        const { backupId, confirm } = body;
        if (!confirm) {
          return NextResponse.json(
            { error: "Restore confirmation required" },
            { status: 400 }
          );
        }

        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
        await restoreFromBackup(backupId);
        return NextResponse.json({
          success: true,
          message: "Restore completed",
        });

      default:
        return NextResponse.json({ error: "Invalid action" }, { status: 400 });
    }
  } catch (error) {
    console.error("Error in backup API:", error);
    return NextResponse.json(
      { error: "Internal Server Error" },
      { status: 500 }
    );
  }
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–∑–∞–≥–ª—É—à–∫–∞)
async function restoreFromBackup(backupId: string) {
  // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:
  // 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ –∏–∑ S3
  // 2. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞
  // 3. –†–∞—Å–ø–∞–∫–æ–≤–∫–∞
  // 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  console.log(`Restoring from backup: ${backupId}`);

  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  if (process.env.NODE_ENV !== "production") {
    console.log("Restore operation simulated in non-production environment");
    return;
  }

  // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –±—ç–∫–∞–ø–∞
  throw new Error("Restore functionality not fully implemented for production");
}
```

### –î–∞—à–±–æ—Ä–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—ç–∫–∞–ø–∞–º–∏

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–∞—à–±–æ—Ä–¥–∞ –±—ç–∫–∞–ø–∞

```tsx
// src/app/admin/backup/page.tsx
'use client';

import { useState, useEffect } from 'react';
import { DashboardLayout } from '@/components/admin/DashboardLayout';

const BackupDashboard = () => {
  const [backupStatus, setBackupStatus] = useState<any>(null);
  const [backups, setBackups] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
  const [actionLoading, setActionLoading] = useState(false);

  useEffect(() => {
    const fetchData = async () => {
      try {
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±—ç–∫–∞–ø–∞
        const statusResponse = await fetch('/api/backup?action=status');
        const statusData = await statusResponse.json();
        setBackupStatus(statusData);

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –±—ç–∫–∞–ø–æ–≤
        const listResponse = await fetch('/api/backup?action=list');
        const listData = await listResponse.json();
        setBackups(listData.backups);
      } catch (error) {
        console.error('Error fetching backup data:', error);
      } finally {
        setLoading(false);
      }
    };

    fetchData();
  }, []);

  const handleCreateBackup = async (type: string) => {
    setActionLoading(true);
    try {
      const response = await fetch('/api/backup', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          action: 'create',
          type
        })
      });

      const result = await response.json();
      if (result.success) {
        alert(`Backup of ${type} completed successfully!`);
        // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
        window.location.reload();
      } else {
        alert(`Backup failed: ${result.error}`);
      }
    } catch (error) {
      console.error('Error creating backup:', error);
      alert('Error creating backup');
    } finally {
      setActionLoading(false);
    }
  };

  const handleRestore = async (backupId: string) => {
    if (!confirm('Are you sure you want to restore from this backup? This will overwrite current data.')) {
      return;
    }

    setActionLoading(true);
    try {
      const response = await fetch('/api/backup', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          action: 'restore',
          backupId,
          confirm: true
        })
      });

      const result = await response.json();
      if (result.success) {
        alert('Restore completed successfully!');
      } else {
        alert(`Restore failed: ${result.error}`);
      }
    } catch (error) {
      console.error('Error restoring backup:', error);
      alert('Error restoring backup');
    } finally {
      setActionLoading(false);
    }
  };

 if (loading) {
    return (
      <DashboardLayout>
        <div className="flex justify-center items-center h-64">
          <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"></div>
        </div>
      </DashboardLayout>
    );
  }

 return (
    <DashboardLayout>
      <div className="space-y-6">
        <div className="flex justify-between items-center">
          <h1 className="text-2xl font-bold">Backup Management</h1>
          <div className="flex space-x-2">
            <button
              onClick={() => handleCreateBackup('database')}
              disabled={actionLoading}
              className="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50"
            >
              {actionLoading ? 'Creating...' : 'Backup Database'}
            </button>
            <button
              onClick={() => handleCreateBackup('mediaFiles')}
              disabled={actionLoading}
              className="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50"
            >
              {actionLoading ? 'Creating...' : 'Backup Files'}
            </button>
            <button
              onClick={() => handleCreateBackup('configs')}
              disabled={actionLoading}
              className="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-70 disabled:opacity-50"
            >
              {actionLoading ? 'Creating...' : 'Backup Configs'}
            </button>
          </div>
        </div>

        {/* –°—Ç–∞—Ç—É—Å –±—ç–∫–∞–ø–∞ */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div className="bg-white rounded-lg shadow p-6">
            <h3 className="text-lg font-semibold mb-2">Last Backup</h3>
            <p className="text-gray-600">{backupStatus?.lastBackup ? new Date(backupStatus.lastBackup).toLocaleString() : 'N/A'}</p>
          </div>

          <div className="bg-white rounded-lg shadow p-6">
            <h3 className="text-lg font-semibold mb-2">Status</h3>
            <p className={`font-medium ${backupStatus?.status === 'success' ? 'text-green-600' : 'text-red-600'}`}>
              {backupStatus?.status?.toUpperCase() || 'N/A'}
            </p>
          </div>

          <div className="bg-white rounded-lg shadow p-6">
            <h3 className="text-lg font-semibold mb-2">Next Backup</h3>
            <p className="text-gray-600">{backupStatus?.nextBackup ? new Date(backupStatus.nextBackup).toLocaleString() : 'N/A'}</p>
          </div>

        {/* –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤ */}
        <div className="bg-white rounded-lg shadow p-6">
          <h2 className="text-lg font-semibold mb-4">Available Backups</h2>
          <div className="overflow-x-auto">
            <table className="min-w-full divide-y divide-gray-200">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Size</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {backups.length === 0 ? (
                  <tr>
                    <td colSpan={5} className="px-6 py-4 text-center text-gray-500">
                      No backups found
                    </td>
                  </tr>
                ) : (
                  backups.map((backup) => (
                    <tr key={backup.id}>
                      <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{backup.id}</td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{backup.type}</td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{backup.date}</td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{backup.size}</td>
                      <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button
                          onClick={() => handleRestore(backup.id)}
                          className="text-red-600 hover:text-red-900 mr-4"
                        >
                          Restore
                        </button>
                        <button className="text-blue-600 hover:text-blue-900">
                          Download
                        </button>
                      </td>
                    </tr>
                  ))
                )}
              </tbody>
            </table>
          </div>

        {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª–∏—Ç–∏–∫–µ –±—ç–∫–∞–ø–∞ */}
        <div className="bg-white rounded-lg shadow p-6">
          <h2 className="text-lg font-semibold mb-4">Backup Policy</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div className="border border-gray-20 rounded-lg p-4">
              <h3 className="font-medium text-gray-900">Database</h3>
              <p className="text-sm text-gray-600">Daily, 30 days retention</p>
            </div>
            <div className="border border-gray-200 rounded-lg p-4">
              <h3 className="font-medium text-gray-900">Media Files</h3>
              <p className="text-sm text-gray-600">Weekly, 90 days retention</p>
            </div>
            <div className="border border-gray-200 rounded-lg p-4">
              <h3 className="font-medium text-gray-900">Configs</h3>
              <p className="text-sm text-gray-600">Daily, 365 days retention</p>
            </div>
            <div className="border border-gray-200 rounded-lg p-4">
              <h3 className="font-medium text-gray-900">Logs</h3>
              <p className="text-sm text-gray-600">Daily, 7 days retention</p>
            </div>
          </div>
        </div>
      </div>
    </DashboardLayout>
  );
};
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### –°–µ—Ä–≤–∏—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±—ç–∫–∞–ø–æ–≤

```typescript
// src/lib/backup-monitoring.ts
import { BackupService } from "./backup-service";

export class BackupMonitoringService {
  static async checkBackupStatus(): Promise<boolean> {
    try {
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞
      const lastBackupDate = await this.getLastBackupDate();
      const timeSinceLastBackup = Date.now() - lastBackupDate.getTime();

      // –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ –±–æ–ª—å—à–µ 24 —á–∞—Å–æ–≤ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞
      if (timeSinceLastBackup > 24 * 60 * 60 * 1000) {
        await this.sendAlert("No backup performed in the last 24 hours");
        return false;
      }

      return true;
    } catch (error) {
      console.error("Error checking backup status:", error);
      await this.sendAlert("Error checking backup status");
      return false;
    }
  }

  static async getLastBackupDate(): Promise<Date> {
    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ –∏–∑ S3 –∏–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    // –ü–æ–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    return new Date();
  }

  static async sendAlert(message: string): Promise<void> {
    // –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Slack, email –∏–ª–∏ –¥—Ä—É–≥–æ–π –∫–∞–Ω–∞–ª
    console.log(`Backup Alert: ${message}`);

    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:
    // 1. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Slack —á–µ—Ä–µ–∑ webhook
    // 2. –û—Ç–ø—Ä–∞–≤–∫–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    // 3. –ó–∞–ø–∏—Å—å –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

    try {
      // –ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Slack
      if (process.env.SLACK_WEBHOOK_URL) {
        await fetch(process.env.SLACK_WEBHOOK_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            text: `üö® Backup Alert: ${message}`,
            channel: "#alerts",
          }),
        });
      }
    } catch (error) {
      console.error("Error sending backup alert:", error);
    }
  }

  static async runHealthCheck(): Promise<any> {
    const results = {
      databaseBackup: await this.verifyDatabaseBackup(),
      filesBackup: await this.verifyFilesBackup(),
      configsBackup: await this.verifyConfigsBackup(),
      storageSpace: await this.checkStorageSpace(),
      overallStatus: "healthy",
    };

    if (
      !results.databaseBackup ||
      !results.filesBackup ||
      !results.configsBackup ||
      !results.storageSpace.ok
    ) {
      results.overallStatus = "unhealthy";
      await this.sendAlert("Backup health check failed");
    }

    return results;
  }

  static async verifyDatabaseBackup(): Promise<boolean> {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    try {
      // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ –≤ S3
      return true;
    } catch (error) {
      console.error("Database backup verification failed:", error);
      return false;
    }
  }

  static async verifyFilesBackup(): Promise<boolean> {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ —Ñ–∞–π–ª–æ–≤
    try {
      // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ —Ñ–∞–π–ª–æ–≤ –≤ S3
      return true;
    } catch (error) {
      console.error("Files backup verification failed:", error);
      return false;
    }
  }

  static async verifyConfigsBackup(): Promise<boolean> {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤
    try {
      // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –≤ S3
      return true;
    } catch (error) {
      console.error("Configs backup verification failed:", error);
      return false;
    }
  }

  static async checkStorageSpace(): Promise<{
    ok: boolean;
    used: string;
    total: string;
  }> {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –æ–±–ª–∞—á–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    try {
      // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–Ω—è—Ç–æ–º –º–µ—Å—Ç–µ –≤ S3
      return { ok: true, used: "45GB", total: "100GB" };
    } catch (error) {
      console.error("Storage space check failed:", error);
      return { ok: false, used: "0", total: "0" };
    }
  }
}
```

## –†–∏—Å–∫–∏ –∏ –º–µ—Ä—ã –ø–æ –∏—Ö —Å–Ω–∏–∂–µ–Ω–∏—é

### –†–∏—Å–∫ 1: –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–±–æ—è—Ö

- **–ú–µ—Ä–∞**: –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—ç–∫–∞–ø–æ–≤
- **–ú–µ—Ä–∞**: –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –†–∏—Å–∫ 2: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

- **–ú–µ—Ä–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤
- **–ú–µ—Ä–∞**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

### –†–∏—Å–∫ 3: –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –±—ç–∫–∞–ø–∞–º

- **–ú–µ—Ä–∞**: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
- **–ú–µ—Ä–∞**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â—É

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

- –ù–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

## –†–µ—Å—É—Ä—Å—ã

- 1-2 DevOps-–∏–Ω–∂–µ–Ω–µ—Ä–∞ –Ω–∞ 9 –Ω–µ–¥–µ–ª—å
- –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –±—ç–∫–∞–ø–æ–≤
- –°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

## –°—Ä–æ–∫–∏

- –ù–∞—á–∞–ª–æ: 1 –¥–µ–∫–∞–±—Ä—è 2025
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ: 6 —è–Ω–≤–∞—Ä—è 2026
- –û–±—â–µ–µ –≤—Ä–µ–º—è: 9 –Ω–µ–¥–µ–ª—å
