# Спецификация Семантического Версионирования 2.0.0 для проекта NormalDANCE

## Обзор

Этот документ описывает реализацию спецификации Семантического Версионирования (SemVer) 2.0.0 для проекта NormalDANCE. Семантическое версионирование - это набор правил и требований, определяющих формат версий и процесс их изменения.

## Формат версии

Версии принимают формат `MAJOR.MINOR.PATCH`:

- `MAJOR` - изменяется при внесении несовместимых изменений API
- `MINOR` - изменяется при добавлении новой функциональности, не нарушающей совместимость
- `PATCH` - изменяется при исправлении ошибок, не нарушающих совместимость

Пример: `1.9.0` или `2.4.5`

## Дополнительные обозначения для предрелизных и метаданных сборки

### Предрелизные теги

Предрелизная версия может быть обозначена добавлением дефиса и идентификатора предрелиза после номера версии:

Примеры:

- `1.0.0-alpha`
- `1.0.0-alpha.1`
- `1.0.0-0.3.7`
- `1.0.0-x.7.z.92`

### Метаданные сборки

Метаданные сборки могут быть добавлены после номера версии с использованием знака плюс:

Примеры:

- `1.0.0+20130313144700`
- `1.0.0+exp.sha.5114f85`
- `1.0.0-alpha+exp.sha.514f85`

## Требования к SemVer 2.0.0

### 1. Определение API

Авторы ПО должны явно определить, что включает в себя их API. Обычно это делается через публичные функции, классы, методы и/или файлы.

### 2. Номера версий увеличиваются

Номера версий увеличиваются только при добавлении новых изменений, а не уменьшаются.

### 3. Обновления версий

- PATCH-версия увеличивается при добавлении совместимых исправлений
- MINOR-версия увеличивается при добавлении новой функциональности без нарушения обратной совместимости, а также при совместимых исправлениях
- MAJOR-версия увеличивается при внесении несовместимых изменений API, а также может включать изменения MINOR и PATCH уровней

### 4. Несовместимые изменения

Несовместимые изменения - это любые изменения, которые могут сломать существующий код или поведение, ожидаемое пользователями.

### 5. Порядок версий

При сравнении версий:

1. Сравниваются MAJOR номера
2. Если равны, сравниваются MINOR номера
3. Если равны, сравниваются PATCH номера
4. Предрелизные теги рассматриваются как младшие по сравнению с соответствующей нормальной версией

## Реализация в проекте NormalDANCE

### Формат версии в package.json

```json
{
  "version": "MAJOR.MINOR.PATCH"
}
```

### Предрелизные версии

Для предрелизных версий используется формат:

- `x.y.z-alpha`
- `x.y.z-beta`
- `x.y.z-rc.1`

### Метаданные сборки

Для обозначения информации о сборке используются метаданные:

- `x.y.z+build.123`
- `x.y.z+20250101.githash`

### Типы коммитов и соответствующие изменения версии

| Тип коммита                     | Тип изменения                | Увеличение версии |
| ------------------------------- | ---------------------------- | ----------------- |
| `feat!:` или `BREAKING CHANGE:` | Несовместимые изменения      | MAJOR             |
| `feat:`                         | Новая функциональность       | MINOR             |
| `fix:`                          | Исправление ошибок           | PATCH             |
| `docs:`                         | Обновление документации      | PATCH             |
| `style:`                        | Изменения форматирования     | PATCH             |
| `refactor:`                     | Рефакторинг кода             | PATCH             |
| `perf:`                         | Улучшения производительности | PATCH             |
| `test:`                         | Изменения в тестах           | PATCH             |
| `chore:`                        | Рутинные задачи              | PATCH             |

### Обработка предрелизных версий

- Alpha-версии: `x.y.z-alpha.n` - для ранних тестов
- Beta-версии: `x.y.z-beta.n` - для предварительных тестов
- Release Candidate: `x.y.z-rc.n` - для финального тестирования перед релизом

### Обработка метаданных сборки

Метаданные сборки включают:

- Информацию о билде
- Хеш коммита Git
- Дату сборки
- Информацию о CI/CD окружении

## Инструменты и автоматизация

### Скрипт управления версиями

Скрипт `scripts/version-manager.js` должен поддерживать:

1. Автоматическое определение типа версии по коммитам
2. Управление предрелизными версиями
3. Добавление метаданных сборки
4. Обновление CHANGELOG.md
5. Создание Git тегов

### Поддерживаемые команды

- `bump major` - увеличить MAJOR версию
- `bump minor` - увеличить MINOR версию
- `bump patch` - увеличить PATCH версию
- `bump pre-release [type]` - создать предрелизную версию (alpha, beta, rc)
- `bump build-metadata [info]` - добавить метаданные сборки
- `current` - показать текущую версию
- `validate` - проверить корректность версии

## Процесс релиза

### Подготовка релиза

1. Автоматическая проверка типа изменений по коммитам
2. Увеличение номера версии
3. Обновление CHANGELOG.md
4. Создание Git тега
5. Пуш тега в репозиторий

### Предрелизный процесс

1. Создание предрелизной ветки
2. Добавление предрелизного тега (alpha, beta, rc)
3. Тестирование
4. При успешном тестировании - переход к финальному релизу

## Совместимость с существующей системой

Новая система должна быть совместима с существующей системой в `docs/versioning-strategy.md`, расширяя её возможности, а не заменяя полностью.

## Примеры использования

### Нормальный релиз

```
1.0.0 -> 1.0.1 (исправление ошибки)
1.0.1 -> 1.1.0 (новая функция)
1.1.0 -> 2.0.0 (несовместимые изменения)
```

### Предрелизные версии

```
1.0.0 -> 1.1.0-alpha.0 -> 1.1.0-alpha.1 -> 1.1.0-beta.0 -> 1.1.0-rc.0 -> 1.1.0
```

### Метаданные сборки

```
1.0.0+build.123
1.0.0-alpha.1+20250101.abc123
```

## Тестирование системы версионирования

Система должна включать автоматические тесты для проверки:

1. Правильности формата версии
2. Правильности увеличения версии
3. Правильности обработки предрелизных тегов
4. Правильности обработки метаданных сборки
5. Совместимости с SemVer 2.0 спецификацией

## Откат версий

В случае необходимости, система должна поддерживать откат к предыдущим версиям с соответствующей документацией процесса.

## Документация и обучение

Все участники проекта должны быть ознакомлены с системой версионирования и правилами оформления коммитов для правильной автоматической генерации версий.
