#!/bin/bash

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∞–π—Ç–∞..."

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ 89.104.67.165
echo "üñ•Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ 89.104.67.165:"
echo "PM2 —Å—Ç–∞—Ç—É—Å:"
pm2 status | grep normaldance

echo ""
echo "–õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ API:"
curl -s http://localhost:3000/api/health | head -1

echo ""
echo "–õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ HTTPS:"
curl -s -k https://89.104.67.165/api/health | head -1

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ 31.31.196.214 (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä REG.RU)
echo ""
echo "üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ 31.31.196.214:"
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–æ–≤:"
timeout 5 bash -c "</dev/tcp/31.31.196.214/80" && echo "‚úÖ –ü–æ—Ä—Ç 80 –æ—Ç–∫—Ä—ã—Ç" || echo "‚ùå –ü–æ—Ä—Ç 80 –∑–∞–∫—Ä—ã—Ç"
timeout 5 bash -c "</dev/tcp/31.31.196.214/443" && echo "‚úÖ –ü–æ—Ä—Ç 443 –æ—Ç–∫—Ä—ã—Ç" || echo "‚ùå –ü–æ—Ä—Ç 443 –∑–∞–∫—Ä—ã—Ç"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
echo ""
echo "‚öôÔ∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx:"
nginx -t

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Nginx
echo ""
echo "üìÑ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏ Nginx:"
tail -n 5 /var/log/nginx/normaldance_error.log 2>/dev/null || echo "–õ–æ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

echo ""
echo "üîß –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ:"

echo ""
echo "1Ô∏è‚É£ –í –ü–ê–ù–ï–õ–ò REG.RU –ò–ó–ú–ï–ù–ò–¢–ï IP –ê–î–†–ï–°:"
echo "   –¢–µ–∫—É—â–∏–π: 31.31.196.214"
echo "   –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: 89.104.67.165"

echo ""
echo "2Ô∏è‚É£ –î–û–ë–ê–í–¨–¢–ï –ò–ù–î–ï–ö–°–ù–´–ï –§–ê–ô–õ–´:"
echo "   index.html, index.php"

echo ""
echo "3Ô∏è‚É£ –ü–†–û–í–ï–†–¨–¢–ï –î–û–°–¢–£–ü–ù–û–°–¢–¨ –ü–û–°–õ–ï –ò–ó–ú–ï–ù–ï–ù–ò–ô:"
echo "   curl -I https://normaldance.ru/"

echo ""
echo "4Ô∏è‚É£ –ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢, –ü–†–û–í–ï–†–¨–¢–ï DNS:"
echo "   nslookup normaldance.ru"

echo ""
echo "üìû –ü–û–î–î–ï–†–ñ–ö–ê REG.RU:"
echo "   –¢–µ–ª–µ—Ñ–æ–Ω: +7 (495) 580-11-11"
echo "   Email: support@reg.ru"